<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Daniel Austin Hoherd">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>ZFS - Daniel Hoherd's tech notes</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "ZFS";
    var mkdocs_page_input_path = "zfs.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Daniel Hoherd's tech notes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">About these notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../3d_printing/">3D Printing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../airport/">Apple Airport</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../amazon-ec2/">Amazon EC2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../amazon/">Amazon</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ansible/">Ansible</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../apfs/">Apple APFS</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aptly/">Aptly</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aria2/">Aria2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../arpwatch/">arpwatch</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../atomicparsley/">AtomicParsley</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../atop/">atop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../autonomous-vehicles/">Autonomous Vehicle Links</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../avahi/">Avahi</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../awk/">awk</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../awless/">awless</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aws-cloudformation/">Amazon AWS Cloudformation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../awscli/">Amazon awscli</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../backups/">Backups</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../badblocks/">badblocks</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bash/">GNU bash</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bbcp/">bbcp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bc/">GNU bc</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bind/">BIND</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../blkid/">blkid</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bluetooth/">bluetooth</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bosh/">BOSH</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bpf/">bpf</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../calico/">calico</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../calver/">CalVer</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../centos/">CentOS Linux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ceph/">Ceph</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../chkconfig/">chkconfig</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../chocolatey/">Choclatey</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../chronos/">chronos</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../circleci/">CircleCI</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cncf/">CNCF</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cobbler/">Cobbler</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../conjure-up/">conjure-up</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../consul/">consul</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cookiecutter/">cookiecutter</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cowsay/">cowsay</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cradlepoint/">Cradlepoint</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cron/">cron</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cryptsetup/">cryptsetup</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../curl/">cURL</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dat/">dat</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../date/">date</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dcfldd/">dcfldd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dcgc/">Docker Custodian</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dcraw/">dcraw</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dd-wrt/">dd-wrt</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dd/">dd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ddrescue/">ddrescue</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../deb/">deb</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../defaults/">defaults</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../devops/">devops</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dhcp/">DHCP</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dig/">dig</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dmidecode/">dmidecode</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dns/">dns</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../docker/">docker</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dsrc/">dsrc</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../dtrace/">dtrace</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../du/">du</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../duplicity/">duplicity</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../education/">education</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../eleduino/">Eleduino</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../etcd/">etcd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ethtool/">ethtool</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../exiftool/">exiftool</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fedramp/">Fedramp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ffmpeg/">ffmpeg</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../figlet/">figlet</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../find/">find</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../findmnt/">findmnt</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../flask/">flask</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fluentd/">fluentd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fortune/">fortune</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../genicam/">GenICam</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../geodata/">geodata</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../gige-vision/">GigE Vision</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../git/">Git</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../gitlab/">Gitlab</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../gitolite/">gitolite</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../glances/">glances</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../golang/">golang</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../google-cloud/">Google Cloud</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../google-earth/">Google Earth</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../google-sheets/">Google Sheets</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../google/">Google</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../graphicsmagick/">GraphicsMagick</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../grub/">GNU GRUB</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../hadoop/">Hadoop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../handbrake/">Handbrake</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../hashids/">Hashids</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../helm/">helm</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../home-assistant/">Home Assistant</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../hp/">HP</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../htop/">htop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../httpstat/">httpstat</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../iTunes/">iTunes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../iftop/">iftop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../image-formats/">Graphical Image Formats</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../imagemagick/">ImageMagick</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../img2xterm/">img2xterm</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../innotop/">innotop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../inotify/">inotify</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../internet/">The Internet</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../iotop/">iotop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ip/">ip</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../iperf/">iperf</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ipmi/">IPMI</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../iptables/">iptables</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jargon/">jargon</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jdupes/">jdupes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jmespath/">jmespath</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jot/">jot</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jpeginfo/">jpeginfo</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jq/">jq</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../json/">JSON</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jsonpath/">JSONPath</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../juniper/">Juniper</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jupyter/">Jupyter</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../jwt/">jwt</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../kaniko/">kaniko</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../keel/">keel</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../keybase/">keybase</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../kubernetes/">kubernetes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../launchd/">launchd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ldap/">ldap</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lego-mindstorms/">lego-mindstorms</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../linksys/">linksys</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../linux-performance-monitoring/">linux-performance-monitoring</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../linux/">linux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../logstash/">logstash</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lsblk/">lsblk</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lshw/">lshw</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lsof/">lsof</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lvm/">lvm</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../lxc/">LXC</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../machine-learning/">Machine Learning</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../make/">GNU make</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../math/">math</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../mdraid/">mdraid</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../metallb/">MetalLB</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../micropython/">MicroPython</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../minikube/">minikube</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../mkdocs/">MkDocs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../mqtt/">mqtt</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../mutt/">mutt</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../myrepos/">myrepos</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../mysql/">MySQL</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../namei/">namei</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ncftp/">ncftp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../netgear/">NETGEAR</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nethogs/">nethogs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../networking/">networking</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../networksetup/">networksetup</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../neverware/">neverware</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nfs/">nfs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nintendo-3ds/">Nintendo 3DS</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nintendo-amiibo/">Nintendo Amiibo</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nintendo-switch/">Nintendo Switch</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nintendo-wii/">Nintendo Wii</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nintendo-wiiu/">Nintendo Wii U</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ntop/">ntop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ntp/">NTP</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nvidia/">nvidia</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../openvpn/">openvpn</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../osquery/">osquery</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ostinato/">ostinato</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../osx/">osx</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../outline/">outline</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../pac/">pac</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../pandoc/">pandoc</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../panopticlick/">panopticlick</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../passwords/">passwords</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../perl/">perl</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../pgp/">pgp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../philips-hue/">philips-hue</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../php/">php</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../plex/">plex</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../postgres/">PostgreSQL</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../powershell/">powershell</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../powertop/">powertop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../procurve/">procurve</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../prometheus/">Prometheus</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../protobuf/">protobuf</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ps/">ps</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ps_mem/">ps_mem</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../psp/">psp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../pssh/">pssh</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ptp/">ptp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../puppet/">Puppet</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../pv/">pv</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../python/">python</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../q/">q</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../raspberry-pi/">raspberry-pi</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../redis/">redis</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rhel/">rhel</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../robotics/">robotics</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../roku/">Roku</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rook/">rook</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ros/">ros</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rpm/">rpm</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rrd/">rrd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rst/">reStructuredText</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rsync/">rsync</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../saltstack/">saltstack</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../samsung/">Samsung</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../screenshot/">Screenshots</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sdr/">sdr</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sed/">sed</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../selinux/">selinux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../semver/">semver</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sensu/">sensu</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../serverless/">serverless</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sgdisk/">sgdisk</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../shairport-sync/">shairport-sync</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../shred/">Shred</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../shutdown/">shutdown</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sips/">sips</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../smartctl/">smartctl</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../smartstack/">smartstack</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../snap/">snap</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../snmp/">snmp</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../solo/">solo</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sort/">sort</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sphinx/">sphinx</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../split/">split</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../splunk/">splunk</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sqlite/">sqlite</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ss/">ss</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ssh/">ssh</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sshuttle/">sshuttle</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../stat/">stat</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../strace/">strace</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sudo/">sudo</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../swagger/">swagger</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../swift/">Swift</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sysctl/">sysctl</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sysdig/">sysdig</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../systemd-resolved/">systemd-resolved</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../systemd/">systemd</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tcl/">TCL</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tcpdump/">tcpdump</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../terraform/">Terraform</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../time/">time</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tls/">tls</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../top-variant-list/">top-variant-list</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../top/">top</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../touch/">touch</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ubuntu/">Ubuntu Linux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../upstart/">Upstart</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../vagrant/">vagrant</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../videos/">Tech videos</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../vim/">vim</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../wget/">Wget</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../winbind/">winbind</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../wireshark/">Wireshark</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../wonder-workshop/">wonder-workshop</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../wuzz/">wuzz</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../xargs/">xargs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../yaml/">yaml</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../youtube-dl/">youtube-dl</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../yum/">yum</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../zerotier/">ZeroTier</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">ZFS</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#links">Links</a></li>
    

    <li class="toctree-l2"><a href="#tips">Tips</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#memory">Memory</a></li>
        
            <li><a class="toctree-l3" href="#log-devices">Log devices</a></li>
        
            <li><a class="toctree-l3" href="#l2arc-cache-devices">l2arc Cache devices</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#zdb">zdb</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#show-the-potential-savings-of-turning-on-dedupe-on-zpool-tank">Show the potential savings of turning on dedupe on zpool tank</a></li>
        
            <li><a class="toctree-l3" href="#show-transactions-and-human-readable-dates-in-the-zdb-history">Show transactions and human readable dates in the zdb history</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#zpool">zpool</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#create-a-zpool-and-its-base-filesystem">Create a zpool and its base filesystem</a></li>
        
            <li><a class="toctree-l3" href="#add-a-cache-device-to-a-pool">Add a cache device to a pool</a></li>
        
            <li><a class="toctree-l3" href="#show-all-configured-zpool-options-for-a-given-zpool">Show all configured zpool options for a given zpool</a></li>
        
            <li><a class="toctree-l3" href="#show-history-of-all-operations-on-a-given-pool">Show history of all operations on a given pool</a></li>
        
            <li><a class="toctree-l3" href="#show-real-time-statistics-on-a-given-zpool">Show real time statistics on a given zpool</a></li>
        
            <li><a class="toctree-l3" href="#show-basic-information-about-all-imported-zpools">Show basic information about all imported zpools</a></li>
        
            <li><a class="toctree-l3" href="#show-deduplication-tables">Show deduplication tables</a></li>
        
            <li><a class="toctree-l3" href="#replace-a-disk-in-a-zpool">Replace a disk in a zpool</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#zfs">zfs</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#show-differences-between-current-filesystem-state-and-snapshot-state">show differences between current filesystem state and snapshot state</a></li>
        
            <li><a class="toctree-l3" href="#show-configured-properties-for-a-filesystem">Show configured properties for a filesystem</a></li>
        
            <li><a class="toctree-l3" href="#show-custom-filesystem-attributes">Show custom filesystem attributes</a></li>
        
            <li><a class="toctree-l3" href="#show-an-overview-of-all-mounted-zfs-filesystems">Show an overview of all mounted zfs filesystems</a></li>
        
            <li><a class="toctree-l3" href="#show-specified-fields-of-each-filesystem">Show specified fields of each filesystem</a></li>
        
            <li><a class="toctree-l3" href="#show-only-snapshots">Show only snapshots</a></li>
        
            <li><a class="toctree-l3" href="#show-space-consumed-by-file-owner">Show space consumed by file owner</a></li>
        
            <li><a class="toctree-l3" href="#disable-atime-updates-for-a-filesystem">Disable atime updates for a filesystem</a></li>
        
            <li><a class="toctree-l3" href="#set-compression-to-lz4-for-a-filesystem">Set compression to lz4 for a filesystem</a></li>
        
            <li><a class="toctree-l3" href="#set-deduplication-to-enabled-for-a-filesystem">Set deduplication to enabled for a filesystem</a></li>
        
            <li><a class="toctree-l3" href="#set-a-filesystem-to-readonly">Set a filesystem to readonly</a></li>
        
            <li><a class="toctree-l3" href="#set-a-filesystem-to-allow-nfs-sharing">Set a filesystem to allow NFS sharing</a></li>
        
            <li><a class="toctree-l3" href="#create-a-dataset">Create a dataset</a></li>
        
            <li><a class="toctree-l3" href="#destroy-multiple-snapshots">Destroy multiple snapshots</a></li>
        
            <li><a class="toctree-l3" href="#zfs-send-receive">zfs send / receive</a></li>
        
            <li><a class="toctree-l3" href="#recursively-zfs-send-a-filesystem-to-a-remote-host-and-recieve-it-as-a-new-dataset">recursively zfs send a filesystem to a remote host and recieve it as a new dataset</a></li>
        
            <li><a class="toctree-l3" href="#show-summary-of-what-would-be-sent">Show summary of what would be sent</a></li>
        
            <li><a class="toctree-l3" href="#show-the-space-differences-between-two-snapshots">Show the space differences between two snapshots</a></li>
        
            <li><a class="toctree-l3" href="#show-the-amount-of-new-space-consumed-by-each-monthly">Show the amount of new space consumed by each monthly</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#complex-examples">Complex examples</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#create-a-raidz-called-tank">Create a raidz called tank</a></li>
        
            <li><a class="toctree-l3" href="#create-a-case-insensitive-raidz3-out-of-50-files">Create a case insensitive raidz3 out of 50 files</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#troubleshooting">Troubleshooting</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#mount-a-pool-that-is-giving-you-trouble">Mount a pool that is giving you Trouble</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#zfs-on-mac-os-x">ZFS on Mac OS X</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#create-a-zfs-partition-on-devdisk3">Create a ZFS partition on /dev/disk3</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#zfs-on-linux">ZFS on Linux</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#centos-6-repository">CentOS 6 Repository</a></li>
        
            <li><a class="toctree-l3" href="#building-on-centos-6">Building on CentOS 6</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../zookeeper/">zookeeper</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Daniel Hoherd's tech notes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>ZFS</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>ZFS is the Zetabyte File System.</p>
<h1 id="links">Links</h1>
<ul>
<li>OpenZFS - <a href="http://open-zfs.org">http://open-zfs.org</a></li>
<li>Tuning Guide - <a href="http://www.solarisinternals.com/wiki/index.php/ZFS_Evil_Tuning_Guide">http://www.solarisinternals.com/wiki/index.php/ZFS_Evil_Tuning_Guide</a></li>
<li>Hardware recommendations - <a href="http://blog.zorinaq.com/?e=10">http://blog.zorinaq.com/?e=10</a></li>
<li>Mac ZFS - <a href="http://code.google.com/p/maczfs/">http://code.google.com/p/maczfs/</a></li>
<li>Shadow migration feature - <a href="http://docs.oracle.com/cd/E23824_01/html/821-1448/gkkud.html">http://docs.oracle.com/cd/E23824_01/html/821-1448/gkkud.html</a></li>
<li>Speed tuning - <a href="http://icesquare.com/wordpress/how-to-improve-zfs-performance/">http://icesquare.com/wordpress/how-to-improve-zfs-performance/</a></li>
<li>ZFS RAID levels - <a href="http://www.zfsbuild.com/2010/05/26/zfs-raid-levels/">http://www.zfsbuild.com/2010/05/26/zfs-raid-levels/</a></li>
<li><a href="http://en.wikipedia.org/wiki/ZFS">http://en.wikipedia.org/wiki/ZFS</a></li>
<li><a href="http://wiki.freebsd.org/ZFSQuickStartGuide">http://wiki.freebsd.org/ZFSQuickStartGuide</a></li>
<li><a href="http://www.solarisinternals.com/wiki/index.php/ZFS_Best_Practices_Guide">http://www.solarisinternals.com/wiki/index.php/ZFS_Best_Practices_Guide</a></li>
<li><a href="http://zfsguru.com">http://zfsguru.com</a></li>
<li><a href="http://zfsonlinux.org/faq.html">http://zfsonlinux.org/faq.html</a></li>
<li><a href="http://www.oracle.com/technetwork/articles/servers-storage-admin/o11-113-size-zfs-dedup-1354231.html">http://www.oracle.com/technetwork/articles/servers-storage-admin/o11-113-size-zfs-dedup-1354231.html</a></li>
<li><a href="http://wiki.freebsd.org/ZFSTuningGuide#Deduplication">http://wiki.freebsd.org/ZFSTuningGuide#Deduplication</a></li>
<li>Corruption / failure to import - <a href="https://github.com/zfsonlinux/zfs/issues/2457">https://github.com/zfsonlinux/zfs/issues/2457</a></li>
<li><a href="https://www.percona.com/blog/2018/05/15/about-zfs-performance/">https://www.percona.com/blog/2018/05/15/about-zfs-performance/</a></li>
<li><a href="https://wiki.freebsd.org/ZFSTuningGuide">https://wiki.freebsd.org/ZFSTuningGuide</a></li>
</ul>
<h1 id="tips">Tips</h1>
<h2 id="memory">Memory</h2>
<ul>
<li>For normal operation, 1gb of memory per tb of disk space is suitable.</li>
<li>For dedup operation, 5gb of memory per tb of addressable disk space is suitable.</li>
</ul>
<h2 id="log-devices">Log devices</h2>
<ul>
<li>Use a log device if you have lots of writes.</li>
<li>Mirror it, because if you lose it you lose the whole volume.</li>
<li>Speed and latency are most important, not size.  Log flushes every 5 seconds.</li>
<li>Get SLC if possible, otherwise MLC</li>
</ul>
<h2 id="l2arc-cache-devices">l2arc Cache devices</h2>
<ul>
<li>Use if you have lots of reads.</li>
<li>Size does matter, with big devices more data can be cached for faster reads of more data.</li>
<li>Speed and latency matter.</li>
<li>Mirrororing l2arc does not matter because if it fails, reads come from the spinning disks.</li>
<li>Too big of a device can suck up resources and cause poor performance. See <a href="https://wiki.freebsd.org/ZFSTuningGuide">https://wiki.freebsd.org/ZFSTuningGuide</a></li>
</ul>
<p>Good explanation: <a href="https://blogs.oracle.com/brendan/entry/test">https://blogs.oracle.com/brendan/entry/test</a></p>
<h1 id="zdb">zdb</h1>
<h2 id="show-the-potential-savings-of-turning-on-dedupe-on-zpool-tank">Show the potential savings of turning on dedupe on zpool tank</h2>
<p><a href="http://hub.opensolaris.org/bin/view/Community+Group+zfs/dedup">http://hub.opensolaris.org/bin/view/Community+Group+zfs/dedup</a></p>
<pre><code>zdb -S tank
</code></pre>

<h2 id="show-transactions-and-human-readable-dates-in-the-zdb-history">Show transactions and human readable dates in the zdb history</h2>
<p>Use <code>zdb -e</code> for pools that are not mounted.</p>
<pre><code>zdb -hh tank \
| egrep 'txg|time' \
| while read -r _ a b ; do
  if [ &quot;$a&quot; == &quot;time:&quot; ] ; then
    date -d @$b &quot;+$a %F %T&quot; ;
  else
    echo &quot;$a  $b&quot; ;
  fi ;
done
</code></pre>

<h1 id="zpool">zpool</h1>
<h2 id="create-a-zpool-and-its-base-filesystem">Create a zpool and its base filesystem</h2>
<pre><code>zpool create -f -o cachefile=/tmp/zpool.cache zpoolname /dev/ada1 #create a zpool
</code></pre>

<h2 id="add-a-cache-device-to-a-pool">Add a cache device to a pool</h2>
<pre><code># add ada0p3 as a cache device to the tank zpool
zpool add tank cache ada0p3
</code></pre>

<h2 id="show-all-configured-zpool-options-for-a-given-zpool">Show all configured zpool options for a given zpool</h2>
<pre><code>zpool get all tank
</code></pre>

<h2 id="show-history-of-all-operations-on-a-given-pool">Show history of all operations on a given pool</h2>
<pre><code># show history of operations on the pool, eg: snapshots, attribute changes
zpool history
</code></pre>

<h2 id="show-real-time-statistics-on-a-given-zpool">Show real time statistics on a given zpool</h2>
<pre><code># show per-device statistics every 1 second
zpool iostat -v 1
</code></pre>

<h2 id="show-basic-information-about-all-imported-zpools">Show basic information about all imported zpools</h2>
<pre><code># show zpool space info, deduplication ratio and health
zpool list
</code></pre>

<h2 id="show-deduplication-tables">Show deduplication tables</h2>
<pre><code># show deduplication table entries. Take entries * size / 1024 / 1024 to calculate DDT consumption
zpool status -D z2
</code></pre>

<h2 id="replace-a-disk-in-a-zpool">Replace a disk in a zpool</h2>
<pre><code># Replace the first disk with the second in the tank pool
zpool replace -f tank /dev/disk/by-id/ata-ST3000DM001-9YN166_W1F09CW9 /dev/disk/by-id/ata-ST3000DM001-9YN166_Z1F0N9S7
</code></pre>

<h3 id="real-example">Real example</h3>
<pre><code>$ zpool replace -f tank /dev/disk/by-id/ata-HGST_HDN724040ALE640_PK1334PCJY9ASS /dev/disk/by-id/ata-HGST_HUH728080ALE600_VKHA6YDX
$ zpool status
  pool: home
 state: ONLINE
  scan: scrub repaired 0 in 0h0m with 0 errors on Sun Dec 10 00:24:07 2017
config:

        NAME                                             STATE     READ WRITE CKSUM
        home                                             ONLINE       0     0     0
          ata-M4-CT064M4SSD2_0000000012170908F759-part4  ONLINE       0     0     0

errors: No known data errors

  pool: tank
 state: DEGRADED
status: One or more devices is currently being resilvered.  The pool will
        continue to function, possibly in a degraded state.
action: Wait for the resilver to complete.
  scan: resilver in progress since Mon Jan  8 19:57:45 2018
    47.1M scanned out of 13.7T at 6.72M/s, 592h39m to go
    11.5M resilvered, 0.00% done
config:

        NAME                                           STATE     READ WRITE CKSUM
        tank                                           DEGRADED     0     0     0
          raidz1-0                                     DEGRADED     0     0     0
            replacing-0                                UNAVAIL      0     0     0
              ata-HGST_HDN724040ALE640_PK1334PCJY9ASS  UNAVAIL      0     1     0  corrupted data
              ata-HGST_HUH728080ALE600_VKHA6YDX        ONLINE       0     0     0  (resilvering)
            ata-HGST_HDN724040ALE640_PK2334PEHG8LAT    ONLINE       0     0     0
            ata-HGST_HDN724040ALE640_PK2334PEHGD37T    ONLINE       0     0     0
            ata-HGST_HDN724040ALE640_PK2338P4H3TJPC    ONLINE       0     0     0

errors: No known data errors
</code></pre>

<h1 id="zfs">zfs</h1>
<h2 id="show-differences-between-current-filesystem-state-and-snapshot-state">show differences between current filesystem state and snapshot state</h2>
<pre><code>zfs diff tank tank@snap
</code></pre>

<h2 id="show-configured-properties-for-a-filesystem">Show configured properties for a filesystem</h2>
<pre><code>zfs get all
</code></pre>

<h2 id="show-custom-filesystem-attributes">Show custom filesystem attributes</h2>
<pre><code># show custom attributes that override inherited attributes
zfs get all -s local tank
</code></pre>

<h2 id="show-an-overview-of-all-mounted-zfs-filesystems">Show an overview of all mounted zfs filesystems</h2>
<pre><code># show disk space including free physical disk space and mount info
zfs list
</code></pre>

<h2 id="show-specified-fields-of-each-filesystem">Show specified fields of each filesystem</h2>
<pre><code># show the listed fields of all filesystems
zfs list -t all -o name,referenced,used,written,creation,userused@root
</code></pre>

<h2 id="show-only-snapshots">Show only snapshots</h2>
<pre><code>zfs list -t snapshot
</code></pre>

<h2 id="show-space-consumed-by-file-owner">Show space consumed by file owner</h2>
<pre><code>zfs userspace tank
</code></pre>

<h2 id="disable-atime-updates-for-a-filesystem">Disable atime updates for a filesystem</h2>
<pre><code>zfs set atime=off tank
</code></pre>

<h2 id="set-compression-to-lz4-for-a-filesystem">Set compression to lz4 for a filesystem</h2>
<pre><code>zfs set compression=lz4 tank
</code></pre>

<h2 id="set-deduplication-to-enabled-for-a-filesystem">Set deduplication to enabled for a filesystem</h2>
<pre><code>zfs set dedup=on tank
</code></pre>

<h2 id="set-a-filesystem-to-readonly">Set a filesystem to readonly</h2>
<pre><code>zfs set readonly=on zpoolname/dataset
</code></pre>

<h2 id="set-a-filesystem-to-allow-nfs-sharing">Set a filesystem to allow NFS sharing</h2>
<pre><code>zfs set sharenfs=on tank
</code></pre>

<h2 id="create-a-dataset">Create a dataset</h2>
<pre><code># create a dataset 'sole' on zpool 'tank'
zfs create tank/sole
</code></pre>

<h2 id="destroy-multiple-snapshots">Destroy multiple snapshots</h2>
<pre><code>zfs destroy tank@20130413-weekly,20130420-weekly,20130428-weekly,20130505-weekly
</code></pre>

<h2 id="zfs-send-receive">zfs send / receive</h2>
<p>Replicate a zpool (use the latest snapshot name as the source) to a blank zpool:</p>
<pre><code>zfs send -v -D -R tank@20120907-oldest | zfs receive -F -v z2
</code></pre>

<ul>
<li>-D enables a deduplicated stream.</li>
<li>-R enables a recursive send of all snapshots and filesystems up to that point.</li>
<li>-F enables deletion of any snapshots on the target that don't exist on the sender</li>
<li>-v enables verbose mode</li>
</ul>
<h2 id="recursively-zfs-send-a-filesystem-to-a-remote-host-and-recieve-it-as-a-new-dataset">recursively zfs send a filesystem to a remote host and recieve it as a new dataset</h2>
<pre><code>zfs send -v -D -R z1@20120907-oldest | ssh otherhost zfs receive -v z2/z1
</code></pre>

<h2 id="show-summary-of-what-would-be-sent">Show summary of what would be sent</h2>
<p>This shows an entire dataset up to the given snapshot</p>
<pre><code>zfs send -n -v -D -R tank@20140531-monthly
</code></pre>

<h2 id="show-the-space-differences-between-two-snapshots">Show the space differences between two snapshots</h2>
<pre><code>zfs send -n -v -D -i tank@20140531-monthly tank@20141031-monthly
</code></pre>

<h2 id="show-the-amount-of-new-space-consumed-by-each-monthly">Show the amount of new space consumed by each monthly</h2>
<pre><code>zfs list -o name | grep 'tank@.*monthly' | while read -r X ; do [[ ! $a =~ .*monthly ]] &amp;&amp; a=$X || zfs send -n -v -D -i $a $X &amp;&amp; a=$X ; done 2&gt;&amp;1 | grep send
</code></pre>

<h1 id="complex-examples">Complex examples</h1>
<h2 id="create-a-raidz-called-tank">Create a raidz called tank</h2>
<p>Create a raidz pool from 4 disks and set some properties:</p>
<pre><code>pool=tank
zpool create -f &quot;${pool}&quot; raidz /dev/disk/by-id/scsi-SATA_HGST_HDN724040A_PK2338P4H*-part1 -o ashift=12
zfs set dedup=on &quot;${pool}&quot;
zpool set listsnapshots=on &quot;${pool}&quot;
zfs set atime=off &quot;${pool}&quot;
zfs set compression=lz4 &quot;${pool}&quot;
</code></pre>

<h2 id="create-a-case-insensitive-raidz3-out-of-50-files">Create a case insensitive raidz3 out of 50 files</h2>
<pre><code>pool=tank
for X in {1..50} ; do mkfile -n 2g ${pool}.$X ; done ;
sudo zpool create -O casesensitivity=insensitive ${pool} raidz3 /Users/danielh/Desktop/Stuff/${pool}/${pool}.{1..50}
</code></pre>

<h1 id="troubleshooting">Troubleshooting</h1>
<h2 id="mount-a-pool-that-is-giving-you-trouble">Mount a pool that is giving you Trouble</h2>
<pre><code>zpool import -o failmode=continue -o readonly=on zpool_name
</code></pre>

<p>This helped me get read access to a pool that was kernel panicking with the following error when I tried to import it normally:</p>
<pre><code>Dec  7 14:48:40 localhost kernel: PANIC: blkptr at ffff8803fddb4200 DVA 0 has invalid OFFSET 294940902907904
</code></pre>

<h1 id="zfs-on-mac-os-x">ZFS on Mac OS X</h1>
<ul>
<li><a href="http://openzfsonosx.org">http://openzfsonosx.org</a></li>
</ul>
<h2 id="create-a-zfs-partition-on-devdisk3">Create a ZFS partition on /dev/disk3</h2>
<pre><code># Must eject device in Disk Utility first
diskutil partitiondisk /dev/disk3 GPTFormat ZFS %noformat% 100% # strange syntax, but works
zpool create backups1 /dev/disk3s2 # create the zpool
mdutil -i off /Volumes/backups1 # required on MacZFS since spotlight does not function
</code></pre>

<h1 id="zfs-on-linux">ZFS on Linux</h1>
<ul>
<li>If you get module errors: <code>modprobe zfs ; ldconfig</code></li>
<li>If you get permission denied, check selinux settings</li>
</ul>
<h2 id="centos-6-repository">CentOS 6 Repository</h2>
<pre><code>sudo yum install -y epel-release # assumes later CentOS 6 where epel is provided upstream
sudo yum localinstall --nogpgcheck http://archive.zfsonlinux.org/epel/zfs-release.el6.noarch.rpm
sudo yum install zfs -y
</code></pre>

<h3 id="reinstalling-when-things-fail">Reinstalling when things fail</h3>
<pre><code>#!/bin/bash -x
yum install -y kernel-devel-$(uname -r)
zfs_version=0.6.5.4
dkms remove  -m zfs -v &quot;${zfs_version}&quot; --all
dkms remove  -m spl -v &quot;${zfs_version}&quot; --all
dkms add     -m spl -v &quot;${zfs_version}&quot; --force
dkms add     -m zfs -v &quot;${zfs_version}&quot; --force
dkms install -m spl -v &quot;${zfs_version}&quot; --force
dkms install -m zfs -v &quot;${zfs_version}&quot; --force
</code></pre>

<h3 id="inspect-the-rpm-for-what-scripts-it-runs">Inspect the rpm for what scripts it runs</h3>
<p>This is useful for debugging failures after kernel upgrade.</p>
<pre><code>rpm -q --scripts zfs-dkms
</code></pre>

<h2 id="building-on-centos-6">Building on CentOS 6</h2>
<pre><code>yum groupinstall &quot;Development tools&quot; &amp;&amp; yum install -y libuuid-devel zlib-devel bc lsscsi mdadm parted kernel-debug
# For spl, then again for zfs:
./configure &amp;&amp; make &amp;&amp; make rpm &amp;&amp; rpm -i *64.rpm
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../zookeeper/" class="btn btn-neutral float-right" title="zookeeper">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../zerotier/" class="btn btn-neutral" title="ZeroTier"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../zerotier/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../zookeeper/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
